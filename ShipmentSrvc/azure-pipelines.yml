trigger:
  batch: true
  paths:
    include:
    - ShipmentSrvc/*

steps:
- task: Docker@1
  displayName: 'Docker build'
  inputs:
    dockerFile: ShipmentSrvc/Dockerfile
    useDefaultContext: false
    buildContext: ShipmentSrvc
    imageName: '$(ACR_SERVER)/PUMRP-micro/shipment-service:$(Build.BuildId)'
- task: Docker@1
  displayName: 'Login to ACR'
  inputs:
    azureSubscriptionEndpoint: $(SERVICE_CONNECTION)
    azureContainerRegistry: $(ACR_SERVER)
    command: login
- task: Docker@1
  displayName: 'Docker push to ACR'
  inputs:
    command: 'push'
    imageName: '$(ACR_SERVER)/PUMRP-micro/shipment-service:$(Build.BuildId)'